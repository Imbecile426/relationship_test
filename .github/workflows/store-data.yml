name: Store Participant Data

on:
  workflow_dispatch:
    inputs:
      name1:
        description: 'Your Name'
        required: true
        type: string
      dob1:
        description: 'Your Date of Birth'
        required: true
        type: string
      name2:
        description: "Partner's Name"
        required: true
        type: string
      dob2:
        description: "Partner's Date of Birth"
        required: true
        type: string

jobs:
  store-data:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Append participant data to JSON file
      run: |
        echo "$(jq --arg name1 "${{ github.event.inputs.name1 }}" --arg dob1 "${{ github.event.inputs.dob1 }}" --arg name2 "${{ github.event.inputs.name2 }}" --arg dob2 "${{ github.event.inputs.dob2 }}" '.participants += [{"name1": $name1, "dob1": $dob1, "name2": $name2, "dob2": $dob2}]' data.json)" > data.json

    - name: Commit and push changes
      run: |
        git config --global user.name 'github-actions[bot]'
        git config --global user.email 'github-actions[bot]@users.noreply.github.com'
        git add data.json
        git commit -m 'Add participant data'
        git push